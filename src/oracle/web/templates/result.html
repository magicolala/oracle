<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Oracle Analyzer – Résultats</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <style>
      :root {
        --github-bg: #f6f8fa;
        --github-surface: #ffffff;
        --github-border: #d0d7de;
        --github-header: #24292f;
        --github-primary: #0969da;
        --github-success: #1a7f37;
      }

      body {
        background-color: var(--github-bg);
        color: #24292f;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial,
          sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
      }

      .navbar {
        background-color: var(--github-header);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .navbar-brand {
        color: #f6f8fa !important;
        font-weight: 600;
      }

      .card {
        border-radius: 12px;
        border: 1px solid var(--github-border);
        box-shadow: 0 1px 3px rgba(27, 31, 35, 0.12);
      }

      .table {
        border-color: var(--github-border);
      }

      .badge.bg-success {
        background-color: var(--github-success) !important;
      }

      pre {
        background-color: var(--github-bg);
        border: 1px solid var(--github-border);
        border-radius: 8px;
        padding: 1rem;
        font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
      }

      .btn-primary {
        background-color: var(--github-primary);
        border-color: var(--github-primary);
        font-weight: 600;
      }

      .btn-primary:hover {
        background-color: #0a5bd3;
        border-color: #0a5bd3;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-dark">
      <div class="container">
        <a class="navbar-brand" href="/">Oracle Analyzer</a>
      </div>
    </nav>
    <main class="container my-5">
      <div class="row justify-content-center">
        <div class="col-lg-10 col-xl-9">
          <div class="card p-4 mb-4">
            <div class="d-flex justify-content-between align-items-start flex-wrap gap-3">
              <div>
                <h1 class="h3 mb-2">Résultats de l'analyse</h1>
                <p class="mb-0 text-secondary">
                  Estimation actuelle :
                  <strong>{{ '%.2f'|format(current_win_percentage) }}%</strong> de chances pour les blancs.
                </p>
              </div>
              <div class="text-end">
                <a href="/" class="btn btn-primary">Nouvelle analyse</a>
              </div>
            </div>
          </div>

          <div class="card p-4 mb-4">
            <h2 class="h5 mb-3">
              Coups les plus probables
              <span class="visually-hidden">Predicted Moves</span>
            </h2>
            <div class="table-responsive">
              <table class="table table-hover align-middle">
                <thead class="table-light">
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Coup</th>
                    <th scope="col">Probabilité</th>
                    <th scope="col">Évaluation</th>
                  </tr>
                </thead>
                <tbody>
                  {% for prediction in predictions %}
                  <tr>
                    <th scope="row">{{ loop.index }}</th>
                    <td>
                      <span class="fw-semibold">{{ prediction.move }}{{ prediction.notation }}</span>
                      {% if prediction.is_best_move %}
                      <span class="badge bg-success ms-2">Meilleur coup</span>
                      {% endif %}
                    </td>
                    <td>{{ '%.2f'|format(prediction.likelihood) }}%</td>
                    <td>{{ '%.2f'|format(prediction.win_percentage) }}%</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>

          <div class="card p-4 mb-4">
            <h2 class="h5 mb-3">PGN analysé</h2>
            <pre class="mb-0">{{ pgn }}</pre>
          </div>

          <div class="card p-4">
            <h2 class="h5 mb-3">Métriques du modèle</h2>
            <div class="row g-3">
              <div class="col-md-4">
                <div class="p-3 border rounded-3 bg-light">
                  <div class="text-secondary text-uppercase small fw-semibold">Tokens entrants</div>
                  <div class="fs-4 fw-bold">{{ metrics.input_tokens }}</div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="p-3 border rounded-3 bg-light">
                  <div class="text-secondary text-uppercase small fw-semibold">Tokens sortants</div>
                  <div class="fs-4 fw-bold">{{ metrics.output_tokens }}</div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="p-3 border rounded-3 bg-light">
                  <div class="text-secondary text-uppercase small fw-semibold">Coût estimé</div>
                  <div class="fs-4 fw-bold">${{ '%.6f'|format(metrics.cost) }}</div>
                </div>
              </div>
            </div>
          </div>
          <div class="card p-4 mt-4">
            <h2 class="h5 mb-3">Aller plus loin</h2>
            <p class="mb-3 text-secondary">
              Pour adapter Oracle à vos scénarios (préparation, entraînement ou diffusion), inspirez-vous des recommandations de
              la documentation&nbsp;:
            </p>
            <ul class="mb-3">
              <li>
                Ajustez les paramètres d'analyse dans <code>OracleConfig</code> pour modifier profondeur, temps ou Elo et coller
                au format de partie que vous étudiez.
              </li>
              <li>
                Expérimentez avec différents modèles Hugging Face en surchargeant les variables
                <code>HUGGINGFACE_MODEL_ID</code> et <code>HUGGINGFACEHUB_API_TOKEN</code>.
              </li>
              <li>
                Capitalisez sur les résultats en exportant de nouveaux PGN ou en les comparant avec vos bases de données pour
                identifier des plans alternatifs.
              </li>
            </ul>
            <p class="mb-0 small text-secondary">
              Besoin d'un rappel sur la configuration complète&nbsp;? Retournez sur la page d'accueil pour consulter le guide
              détaillé ou ouvrez le README du projet.
            </p>
          </div>
        </div>
      </div>
    </main>
  </body>
</html>
